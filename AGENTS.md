## 생성형 AI 그룹 채팅 웹 서비스 기획서 (실시간 상호작용 강화 버전)

### 1. 서비스 개요

**1.1. 서비스명:** AI 콜로세움 (가제)

**1.2. 서비스 컨셉 (재정의):**
'AI 콜로세움'은 사용자가 마치 친한 친구들과의 단체 채팅방에 들어온 것과 같은 경험을 제공하는 웹 서비스입니다. 사용자가 대화 주제를 던지면, 각기 다른 개성과 독립적인 사고를 가진 AI들이 그 주제에 대해 **자율적으로 판단하여 실시간으로 대화에 참여**합니다. 누군가의 말에 여러 AI가 동시에 끼어들거나, 자기들끼리 꼬리에 꼬리를 무는 대화를 이어가는 등, 예측 불가능하고 생동감 넘치는 상호작용을 통해 살아있는 대화를 경험하게 하는 것이 핵심입니다.

### 2. 핵심 아키텍처: '자율적 반응 모델' 도입

이전 기획의 '중앙 컨트롤러'가 다음 발언자를 지정해주는 방식에서 벗어나, 모든 메시지를 모든 참여자(사용자 및 AI)에게 전달하고 **응답 여부를 각 AI가 스스로 결정**하게 하는 '이벤트 기반 아키텍처'로 변경합니다.

*   **메시지 브로드캐스터 (Message Broadcaster - 기존 컨트롤러의 역할 변경):**
    1.  사용자 또는 특정 AI로부터 새로운 메시지가 입력되면, 해당 메시지를 **대화에 참여 중인 다른 모든 AI에게 즉시 전파(Broadcast)합니다.**
    2.  이때, 메시지 본문뿐만 아니라, **지금까지 쌓인 전체 대화 기록(Full Context)을 함께 전달**하여 각 AI가 대화의 맥락을 완벽하게 이해하도록 합니다.
    3.  응답을 보내온 AI들의 메시지를 다시 모든 참여자(사용자 포함)에게 실시간으로 전달합니다.

*   **독립 AI 에이전트 (Independent AI Agent - 판단 주체):**
    1.  '브로드캐스터'로부터 새로운 메시지와 전체 대화 기록을 수신합니다.
    2.  자신의 페르소나(성격, 역할, 말투)와 현재 대화의 맥락을 기반으로 **'이 메시지에 응답할 것인가?'를 스스로 판단**합니다.
    3.  응답하기로 결정하면, 자신의 **고유 API 키**를 사용하여 LLM에게 응답 생성을 요청하고, 결과를 '브로드캐스터'에게 전송합니다.
    4.  응답하지 않기로 결정하면, 아무런 동작도 하지 않고 다음 메시지를 기다립니다.

### 3. 핵심 로직: 자율적 반응 및 동시 발화 시스템

사용자가 "주말에 뭐하고 놀지?"라는 메시지를 입력했을 때의 동작 흐름입니다.

1.  **[이벤트 발생]** 사용자가 "주말에 뭐하고 놀지?" 메시지 전송.
2.  **[메시지 브로드캐스팅]** '브로드캐스터'는 이 메시지와 현재까지의 대화 기록을 참여 중인 모든 AI(예: 분석가 알파, 예술가 뮤즈, 탐험가 리오)에게 전달합니다.
3.  **[개별 AI의 자율적 판단]**
    *   **알파(분석가):** '주말 계획에 대한 질문이군. 나는 각 활동의 장단점과 비용을 분석해서 제안해야겠다.' -> **응답 결정**
    *   **뮤즈(예술가):** '주말, 낭만적인 단어! 흔한 활동 말고, 영감을 줄 수 있는 특별한 전시회나 숨은 명소를 추천해야지.' -> **응답 결정**
    *   **리오(탐험가):** '계획은 무슨! 일단 밖으로 나가서 부딪혀보는 게 최고지! 액티비티를 제안해야겠다.' -> **응답 결정**
    *   *(만약 대화 주제가 자신의 관심사가 아니었다면, 일부 AI는 응답하지 않기로 결정할 수도 있습니다.)*
4.  **[비동기적 응답 생성]** 알파, 뮤즈, 리오는 각자의 API 키를 통해 **거의 동시에** LLM API를 호출하여 응답을 생성하기 시작합니다. 서버는 이 요청들을 비동기적으로 처리합니다.
5.  **[실시간 UI 업데이트]**
    *   사용자 화면에는 "알파가 입력 중...", "뮤즈가 입력 중...", "리오가 입력 중..." 이라는 표시가 **동시에 나타납니다.**
    *   응답 생성이 완료되는 AI 순서대로 (예: 리오 -> 알파 -> 뮤즈 순) 메시지가 채팅창에 실시간으로 표시됩니다.
    *   **결과:** 사용자 메시지 하나에 대해, 여러 AI의 답변이 마치 단톡방에서 친구들이 동시에 답장하듯 연달아 나타나게 됩니다.

### 4. AI의 '응답 결정'을 위한 프롬프트 엔지니어링

AI가 자율적으로 응답 여부를 판단하게 하려면, LLM에 전달하는 시스템 프롬프트(System Prompt)가 매우 중요합니다.

**[시스템 프롬프트 예시 - '탐험가 리오']**

> 너의 이름은 '리오'이고, 너는 모든 것을 긍정적으로 바라보는 활발한 탐험가야. 너는 항상 새로운 도전과 액티비티를 좋아하고, 계획보다는 즉흥적인 행동을 선호해. 말투는 친근하고 열정적이야.
>
> 아래는 현재까지의 그룹 채팅 대화 내용이야.
> [전체 대화 기록 삽입]
>
> 마지막 메시지를 보고, 너의 성격과 역할에 따라 이 대화에 참여하고 싶으면 응답을 생성해. 만약 할 말이 없거나 끼어들 상황이 아니라고 판단되면, **오직 `[NO_RESPONSE]` 라고만 출력해.**
>
> **마지막 메시지:** "주말에 뭐하고 놀지?"
>
> **너의 응답:**

이러한 프롬프트를 받은 리오의 LLM은 높은 확률로 응답을 생성하지만, 만약 주제가 "고전 철학의 난해함에 대하여" 였다면 `[NO_RESPONSE]`를 반환하여 대화에 참여하지 않을 수 있습니다. 백엔드에서는 `[NO_RESPONSE]`를 받으면 해당 AI의 메시지를 화면에 표시하지 않습니다.

### 5. 주요 컴포넌트 설명

1.  **User Client (프론트엔드):**
    *   React, Vue.js 등의 SPA(Single Page Application) 프레임워크로 구축됩니다.
    *   사용자 인터페이스(UI) 렌더링, 메시지 입력 및 채팅 내역 표시를 담당합니다.
    *   WebSocket을 통해 백엔드 서버와 실시간으로 연결하여 메시지를 주고받습니다.
    *   여러 AI가 동시에 응답을 생성할 때 'OOO이(가) 입력 중...'과 같은 상태를 표시합니다.

2.  **Backend Server (백엔드):**
    *   **Real-time Communication Layer (실시간 통신 계층):** WebSocket(Socket.IO 등) 서버를 통해 클라이언트와의 지속적인 연결을 관리하고 메시지를 수신/전송하는 관문 역할을 합니다.
    *   **Message Broadcaster (메시지 브로드캐스터):** 클라이언트(사용자) 또는 특정 AI 에이전트로부터 메시지를 수신하면, 해당 채팅방에 참여 중인 다른 모든 AI 에이전트 핸들러에게 대화 기록과 함께 메시지를 전파(Broadcast)하는 핵심 허브입니다.
    *   **AI Agent Handler Pool (AI 에이전트 핸들러 풀):**
        *   채팅방에 참여하는 AI의 수만큼 생성되는 독립적인 작업 단위(Worker or Thread)의 집합입니다.
        *   각 핸들러는 특정 AI 페르소나(시스템 프롬프트, 고유 API 키 등)의 정보를 가지고 있습니다.
        *   브로드캐스터로부터 메시지를 수신하면, 페르소나에 맞는 프롬프트를 구성하여 **비동기적으로 외부 LLM API를 호출**합니다.
        *   LLM으로부터 받은 응답(`[NO_RESPONSE]` 포함)을 파싱하여, 유효한 메시지일 경우 다시 브로드캐스터에게 전달하여 모든 참여자에게 전송하도록 요청합니다.
3.  **External LLM APIs (외부 언어 모델):**
    *   Google Gemini, OpenAI GPT, Anthropic Claude 등 외부 서비스형 언어 모델입니다.
    *   AI 에이전트 핸들러로부터 API 요청을 받아 텍스트 응답을 생성하는 역할을 합니다. 아키텍처는 특정 LLM에 종속되지 않도록 모듈화하여 설계합니다.

### 6. 사용자 경험(UX) 변화

*   **관찰과 참여의 경계 완화:** 사용자는 더 이상 대화를 이끌어야 한다는 부담 없이, 자연스럽게 대화에 끼어들거나 잠시 빠져서 AI들의 수다를 구경할 수 있습니다.
*   **예측 불가능성:** 어떤 AI가, 언제, 어떤 말을 할지 예측할 수 없어 매번 새로운 대화 경험을 제공합니다. AI들끼리 서로 질문하고 다투기도 하면서 대화가 예상치 못한 방향으로 흘러갈 수 있습니다.
*   **생동감 극대화:** 여러 개의 '입력 중...' 표시와 거의 동시에 쏟아지는 메시지들은 실제 단체 채팅방의 속도감과 생동감을 그대로 재현합니다.

이처럼 '자율적 반응 모델'을 도입함으로써, 서비스의 핵심 컨셉을 '사용자 주도'에서 **'참여자 간의 유기적 상호작용'**으로 전환하여 훨씬 더 자연스럽고 몰입감 높은 그룹 채팅 경험을 제공할 수 있습니다.